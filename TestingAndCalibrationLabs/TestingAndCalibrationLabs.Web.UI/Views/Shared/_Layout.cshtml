
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AdminLTE 3 | Starter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" href="~/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
    <link rel="stylesheet" href="~/adminlte.min.css">
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="~/plugins/jquery-ui/jquery-ui.min.js"></script>
    <script>
        $.widget.bridge('uibutton', $.ui.button)
    </script>
    <script src="~/adminlte.min.js"></script>
    <link href="~/css/bootstrap-utilities.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/site.css" />
    <link href="~/css/TestDetails.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/Style.css" />
    <link rel="stylesheet" href="~/css/Login.css" />
    <link rel="stylesheet" href="~/css/Snackbar.css" />
    <link rel="stylesheet" href="~/css/TestDetails.css" />
    <link rel="stylesheet" href="~/css/footerNavcss.css">
    <link rel="stylesheet" href="~/css/Notification.css" />
    <link href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/responsive/2.1.1/css/responsive.bootstrap.min.css" rel="stylesheet" />

    <!---Importing the Scripts--->
    <link href="~/css/Buttons.css" rel="stylesheet" />
    <link href="~/css/bootstrap-utilities.css" rel="stylesheet" />
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/CustomJS.js"></script>
    <script src="~/js/custom.js"></script>
    <script src="~/js/Notification.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
    <script type="text/JavaScript" src="https://cdn.jsdelivr.net/npm/lodash@4.17.20/lodash.min.js"></script>
    <!-- Bootstrap JavaScript -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <style>
        label:not(.form-check-label):not(.custom-file-label) {
            font-weight: normal;
        }

        .fa-edit {
            color: #663399;
        }

        .fa-trash {
            color: red;
        }

        .dropdown-menu {
            overflow-y: scroll;
            border: 1px solid #ccc;
            min-height: 50px;
            max-height: 84vh;
            flex-basis: 0.000000001px;
        }

        #Contents {
            min-height: 84vh !important;
            max-height: 84vh !important;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .dropdown-menu::-webkit-scrollbar {
            width: 4px;
        }

        .dropdown-menu {
            overflow: auto;
        }

        
        #RightSideMenuAside::-webkit-scrollbar {
            width: 4px;
        }

        #RightSideMenuAside {
            overflow: auto;
        }
    </style>
</head>

<body class="sidebar-mini sidebar-collapse" style="margin: 0;padding: 0; overflow:hidden">
    <div class="wrapper">
        @await Html.PartialAsync("~/Views/Shared/_Navbar.cshtml")
        @await Html.PartialAsync("~/Views/Shared/_SideBar.cshtml")
        <div class="content-wrapper" id="Contents">
            @RenderBody()
        </div>
        <footer class="border-top-footer text-muted" id=footer style="background-color: #2a4472; position:fixed">
            <div class="text-center p-3 text-white">
                © 2022 Copyright :
                <a class="text-white" href="#">TESTING AND CALIBRATION LABS</a>
            </div>
            <div class="bottom-navigation" id="data">
                @await Html.PartialAsync("~/Views/Shared/_MobileNavigation.cshtml")
            </div>
        </footer>
        <aside class="control-sidebar control" id="RightSideMenuAside" style="background:white; /*max-height: calc(100vh - 56px);*/">
            <nav class="mt-2" style=" min-height:595px; overflow-x:hidden;   flex-basis:0.000000001px">
                <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" id="RightNavMenu" role="menu" data-accordion="false">
                </ul>
            </nav>
        </aside>
    </div>
    @RenderSection("scripts", required: false)
</body>
</html>
<script>
    $(document).ready(function () {
        var originalData = [];

        function createTopNavItem(item) {
            var dropdownCode = `  <li class="nav-item dropdown"><a class="nav-link" data-toggle="dropdown" href="#"><i class="${item.iconName} nav-icon"style="font-size:15px;"></i></a>  <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">`;

            if (item.childrens) {
                var code = createTopNavMenu(item.childrens);
                dropdownCode += code;
            }
            dropdownCode += "</li>";
            return dropdownCode;
        }

        function createTopNavMenu(menuItems) {
            let htmlCode = '';
            menuItems.forEach(item => {
                htmlCode += `<a href="${item.url}"class="dropdown-item"><i class="${item.iconName}  nav-icon"></i>  ${item.moduleName} </a> <div class="dropdown-divider"></div> `;
            });
            htmlCode += '</div>';
            return htmlCode;
        }

        function createNavBottomItem(item) {
            var dropdownCode = `<li><a  href="#"  class="feat-btn" onclick="showdropdown(this)"><i class="${item.iconName}"></i> ${item.name}<span class="fas fa-caret-down "></span></a>`;
            if (item.childrens) {
                var code = createBottomNavMenu(item.childrens);
                dropdownCode += code;
            }
            dropdownCode += "</li>";
            return dropdownCode;
        }

        function createBottomNavMenu(menuItems) {
            let htmlCode = '<ul class="feat-show">';
            menuItems.forEach(item => {
                htmlCode += `<li><a href="${item.url}"><i class="${item.iconName}"></i> ${item.moduleName}</a></li>`;
            });
            htmlCode += '</ul>';
            return htmlCode;
        }
        function createNavItem(item) {
            var dropdownCode = `   <li class="nav-item"><a href="#" class="nav-link active" ><i class="${item.iconName} nav-icon"></i><p> ${item.name}<i class="right fas fa-angle-left "></i></p></a>`;
            if (item.childrens) {
                var code = createNavMenu(item.childrens);
                dropdownCode += code;
            }
            dropdownCode += "</li>";
            return dropdownCode;
        }

        function createNavMenu(menuItems) {
            let htmlCode = '<ul class="nav nav-treeview">';
            menuItems.forEach(item => {
                htmlCode += `<li class="nav-item" ><a href="${item.url}"class="nav-link "><i class="${item.iconName}  nav-icon"></i><p>  ${item.moduleName}</p> </a>  </li>`;
            });
            htmlCode += '</ul>';
            return htmlCode;
        }
        function renderNavigation() {
            const dynamicNavContainer = $("#SideBar-ContentDropdown");
            const dynamicRightSideNavbar = $("#RightNavMenu");
            const dynamicTopNavbar = $("#TopNavItem");
            const dynamicBottomNavContainer = $("#dynamicBottomContainer");
            originalData.forEach((item) => {
                if (item.navigationTypes === 1025) {
                    dynamicNavContainer.append(createNavItem(item));
                }
                if (item.navigationTypes === 1024) {
                    dynamicRightSideNavbar.append(createNavItem(item));
                }
                if (item.navigationTypes === 1022) {
                    dynamicTopNavbar.prepend(createTopNavItem(item));
                }
                if (item.navigationTypes === 1023) {
                    dynamicBottomNavContainer.append(createNavBottomItem(item));
                }
            });
        }

        $.ajax({
            type: "POST",
            url: "/UiPageNavigation/GetAllPagesWithNavigation",
            success: function (response) {
                response.sort(function (a, b) {
                    if (a.orders < b.orders) { return 1; }
                    if (a.orders > b.orders) { return -1; }
                    return 0;
                });
                originalData = response;
                renderNavigation();
            },
            error: function (req, status, error) {
                console.log(req);
                console.log(status);
                console.log(error);
            }
        });
    });
</script>

