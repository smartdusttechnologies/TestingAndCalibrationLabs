<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/footerNavcss.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* Add your custom styles here */
        .custom-nav-link {
            height: 60px;
            width: 160px;
            background-color: #007bff;
            color: white;
            display: flex;
            align-items: center;
            padding: 10px; /* Increase or decrease this value to adjust the space */
            margin: 5px;
        }

        .custom-nav-link {
            box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);
        }

            .custom-nav-link i {
                margin-right: 10px;
            }

        .top-level {
            background-color: #007bff;
        }

    </style>
</head>
<body>
    <footer class="main-footer Site-head pad-top-500 pad-bottom-500">
        <div>
            <nav class="bottom-navigation">
                <div id="NavbarMenu"></div>
                <div class="w3-teal" onclick="openFooterNav()">
                    <span style="font-size:30px;">&#9776;</span>
                    <span>MENU</span>
                </div>
            </nav>
        </div>
    </footer>

    <div id="myNav" class="overlay">
        <div class="overlay-content" id="main-menu">
            <ul class="nav flex-column" id="mob-navbarContentAdd">
            </ul>
        </div>
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    </div>

    <script>
        var originalData = [];
        $(document).ready(function () {
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetAllPagesWithNavigation","UiPageNavigation")",
                success: function (response) {
                    response.sort(function (a, b) {
                        if (a.orders < b.orders) { return 1; }
                        if (a.orders > b.orders) { return -1; }
                        return 0;
                    });
                    for (let i = 0; i < response.length; i++) {
                        originalData.push(response[i]);
                    }
                },
                error: function (req, status, error) {
                    console.log(req);
                    console.log(status);
                    console.log(error);
                }
            });
        });
        function openFooterNav() {
            document.getElementById("myNav").style.width = "50%";
            document.querySelector(".closebtn").style.display = "block";
            var menuContent = document.getElementById("mob-navbarContentAdd");
            menuContent.innerHTML = "";

            originalData.forEach(function (item) {
                var iconHtml = '<i class="fas fa-' + getIconClass(item.name) + '"></i>';
                var hasSubmenu = item.childrens.length > 0;
                var submenuClass = hasSubmenu ? "collapsed" : "";
                var liElement = document.createElement("li");
                var aElement = document.createElement("a");

                aElement.classList.add("custom-nav-link");
                aElement.innerHTML = iconHtml + item.name + '<i style="margin-left: 10px;" class="fas fa-angle-left" id="item_' + item.id + '"></i';
                aElement.onclick = function () {
                    toggleSubMenu(item.id);
                };

                liElement.classList.add("nav-item");
                liElement.appendChild(aElement);

                if (item.childrens.length > 0) {
                    var ulElement = document.createElement("ul");
                    ulElement.id = "submenu_" + item.id;
                    ulElement.classList.add("collapsed");
                    item.childrens.forEach(function (child) {
                        var subLiElement = document.createElement("li");
                        var subAElement = document.createElement("a");
                        subAElement.classList.add("custom-nav-link");
                        subAElement.href = child.url;
                        subAElement.innerText = child.moduleName;
                        subLiElement.classList.add("nav-item");
                        subLiElement.appendChild(subAElement);
                        ulElement.appendChild(subLiElement);
                    });

                    liElement.appendChild(ulElement);
                }

                menuContent.appendChild(liElement);
            });
        }

        function getIconClass(name) {
            switch (name) {
                case "Settings":
                    return "cog";
                case "Notifications":
                    return "bell";
                case "Profile":
                    return "user";
                default:
                    return "circle";
            }
        }

        function toggleSubMenu(iconId) {
            var submenu = document.getElementById("submenu_" + iconId);
            var icon = document.getElementById("item_" + iconId);

            if (submenu.classList.contains("collapsed")) {
                submenu.classList.remove("collapsed");
                icon.classList.remove("fa-angle-left");
                icon.classList.add("fa-angle-down");
            } else {
                submenu.classList.add("collapsed");
                icon.classList.remove("fa-angle-down");
                icon.classList.add("fa-angle-left");
            }
        }

        function closeNav() {
            document.getElementById("myNav").style.width = "0";
        }
    </script>
</body>
</html>
