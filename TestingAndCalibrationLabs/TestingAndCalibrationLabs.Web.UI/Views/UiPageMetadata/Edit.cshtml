@model TestingAndCalibrationLabs.Web.UI.Models.UiPageMetadataDTO
@{
    ViewData["Title"] = "Edit";
}
<h1>Ui Page Metadata</h1>
<h4>Edit</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Edit" _lpchecked="1" class="mb-2" id="pageForm" method="post" asp-controller="UiPageMetadata" novalidate>
            <div asp-validation-summary="All"></div>
            <div class="row ms-1 me-1">
                <div class="col-lg-8  col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input">
                    <select class="form-input width-full black-border " name="ModuleLayoutId" id="ModuleLayout" onchange="this.setAttribute('value',this.value)" asp-for="ModuleLayoutId">
                        <option disabled="disabled" selected="selected">Select ModuleLayoutName ...</option>
                        @foreach (var item in ViewBag.Modulelist)
                        {
                            if (@item.Id == @ViewBag.ModuleLayoutId)
                            {
                                <option value=@item.Id selected>@item.Name</option>
                            }
                            else
                            {
                                <option value=@item.Id>@item.Name</option>
                            }
                        }
                    </select>
                    <label for="ModuleLayoutId" class="form-label">
                        ModuleLayoutName
                    </label>
                </div>
                <div class="col-lg-8  col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input">
                    <select class="form-input width-full black-border " name="UiPageTypeId" id="UiPageType" onchange="this.setAttribute('value',this.value)" asp-for="UiPageTypeId">
                        <option disabled="disabled" selected>Select Pages ...</option>
                        @foreach (var item in ViewBag.UiPageTypes)
                        {
                            if (@item.Id == @ViewBag.UiPageTypeId)
                            {
                                <option value=@item.Id selected>@item.Name</option>
                            }
                            else
                            {
                                <option value=@item.Id>@item.Name</option>
                            }
                        }
                    </select>
                    <label for="UiPageTypeId" class="form-label">
                        UiPageTypeName
                    </label>
                </div>
                <div class="col-lg-8 col-sm-12 col-xs-12 mt-3 ms-3">
                    <div id="payInvoice" class="floatBlock">
                        <label for="paymentInv">
                            <input id="paymentInv" onclick="NonExixt()" name="paymentType" type="radio" value="INVOICE" /> New
                        </label>
                    </div>
                    <div id="pay3rdParty" class="floatBlock">
                        <label for="payment3rd">
                            <input id="payment3rd" onclick="ModuleGet()" name="paymentType" type="radio" /> Existing
                        </label>
                    </div>
                </div>
               
                <div class="col-lg-8  col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input" id="UiControlType">
                    <select class="form-input width-full black-border" name="UiControlTypeId"  onchange="this.setAttribute('value',this.value)" asp-for="UiControlTypeId">
                        <option disabled="disabled" selected>Select ControlType ...</option>
                        @foreach (var item in ViewBag.UiControlTypes)
                        {
                            if (@item.Id == @ViewBag.UiControlTypeId)
                            {
                                <option value=@item.Id selected>@item.Name</option>
                            }
                            else
                            {
                                <option value=@item.Id>@item.Name</option>
                            }
                        }
                    </select>
                    <label for="UiControlTypeId" class="form-label">
                    UiControlTypeName
                    </label>
                </div>
                <div class="col-lg-8  col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input">
                    <select class="form-input width-full black-border " name="UiControlCategoryTypeId" id="UiControlCategoryType" onchange="this.setAttribute('value',this.value)" asp-for="UiControlCategoryTypeId">
                        <option disabled="disabled" selected>Select CategoryType ...</option>
                        @foreach (var item in ViewBag.UiControlCategoryType)
                        {
                            if (@item.Id == @ViewBag.UiControlCategoryTypeId)
                            {
                                <option value=@item.Id selected>@item.Name</option>
                            }
                            else
                            {
                                <option value=@item.Id>@item.Name</option>
                            }
                        }
                    </select>
                    <label for="UiControlCategoryTypeId" class="form-label">
                        UiControlCategoryTypeName
                    </label>
                </div>
                <div class="col-lg-8  col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input">
                    <select class="form-input width-full black-border" name="DataTypeId" id="DataType" onchange="this.setAttribute('value',this.value)" asp-for="DataTypeId">
                        <option disabled="disabled" selected>Select Data Type ...</option>
                        @foreach (var item in ViewBag.DataTypes)
                        {
                            if (@item.Id == @ViewBag.DataTypeId)
                            {
                                <option value=@item.Id selected>@item.Name</option>
                            }
                            else
                            {
                                <option value=@item.Id>@item.Name</option>
                            }
                        }
                    </select>
                    <label for="DataType" class="form-label">
                        DataType
                    </label>
                </div>
                <div class="row ms-1 me-1">
                    <div class="col-lg-3  col-sm-12 col-xs-12 mt-3">
                        <div class="form-group form-check">
                            <label class="form-check-label">
                                <input class="form-check-input" asp-for="IsRequired" /> @Html.DisplayNameFor(model => model.IsRequired)
                            </label>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8  col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input">
                    <select class="form-input width-full black-border" name="ParentId" id="Parent" onchange="this.setAttribute('value',this.value)" asp-for="ParentId">
                        <option disabled="disabled" selected>Select ParentName ...</option>
                        @foreach (var item in ViewBag.displayName)
                        {
                            if (@item.Id == @ViewBag.ParentId)
                            {
                                <option value=@item.Id selected>@item.UiControlDisplayName</option>
                            }
                            else
                            {
                                <option value=@item.Id>@item.UiControlDisplayName</option>
                            }
                        }
                    </select>
                    <label for="ParentId" class="form-label">
                        ParentName
                    </label>
                </div>
                <div class="col-lg-8 col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input ui-page-metadata-select">
                    <select class="form-input width-full black-border " name="UiPageMetadataId" id="UiPageMetadata" placeholder=" " rows="1" onchange="this.setAttribute('value',this.value)" for="UiPageMetadataId" />
                    <option disabled="disabled" selected>Select UiPageMetadata ...</option>
                    </select>
                                        <label class="form-label" for="UiPageMetadataId"> UiPageMetadata</label>
                     <span asp-validation-for="UiPageMetadataId" class="text-danger"></span>
                </div>
                <div class="col-lg-8  col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-input">
                    <select class="form-input width-full black-border" name="MultiValueControl" id="MultiValueControl" onchange="this.setAttribute('value',this.value)" asp-for="MultiValueControl">
                        <option disabled="disabled" selected>Select MultiValueControl ...</option>
                        <option value="True">True</option>
                        <option value="False">False</option>
                    </select>
                    <label for="MultiValueControl" class="form-label">
                        MultiValueControl
                    </label>
                </div>
                <div class="col-lg-8 col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-frm-input">
                    <input class="form-input width-full black-border" type="text" id="Orders" name="Orders" placeholder=" " onchange="this.setAttribute('value',this.value)" asp-for="Orders">
                    <label class="form-label" for="Orders">Orders</label>
                </div>
                <div class="col-lg-8 col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-frm-input">
                    <input class="form-input width-full black-border" type="text" id="UiControlDisplayName" name="UiControlDisplayName" placeholder=" " onchange="this.setAttribute('value',this.value)" asp-for="UiControlDisplayName">
                    <label class="form-label" for="UiControlDisplayName">UiControlDisplayName</label>
                </div>
                <div class="col-lg-8 col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-frm-input">
                    <input class="form-input width-full black-border" type="text" id="Name" name="Name" placeholder=" " onchange="this.setAttribute('value',this.value)" asp-for="Name">
                    <label class="form-label" for="Name">Name</label>
                </div>
                
                <div class ="col-lg-8 col-sm-12 col-xs-12 mt-3 form-element-for-common-control  right-pd-frm-input">
                    @Html.HiddenFor(m => m.Id)
                    @Html.HiddenFor(m => m.MetadataModuleBridgeId)
                    <input type="submit" value="Save" class="btn btn-lg btn-submit-print text-white" style=" background-color:#4250b5;" onclick="return DisplayProgressMessage(this, 'Saving...');" />
                </div>
            </div>
        </form>
    </div>
</div>

<div>
    <a asp-action="Index">Back to List</a>
</div>
<script>
    
    function ModuleGet() {
        var selectElement = document.querySelector('.ui-page-metadata-select');
        selectElement.style.display = 'block';  // Show the dropdown
        var moduleLayoutId = document.getElementById('ModuleLayout').value
        $.ajax({
            type: "GET",
            url: "@Url.Action("GetExistingResult","UiPageMetadata")",
            data: { moduleLayoutId: moduleLayoutId },
            success: function (response) {
                
                // Clear drop down list
                $("#UiPageMetadata").empty();
                document.getElementById('UiControlType').style.display = 'none';
                // Fill drop down list with new data
                
                for (var i = 0; i < response.length; i++) {
                    var MetadataId = response[i].id;
                    var ControleName = response[i].controlTypeName;
                    if (i == 0) {
                        $("#UiPageMetadata").val(MetadataId);
                        $("#UiPageMetadata").append("<option value='" + MetadataId + "' selected>" + ControleName + "</option>");
                    } else {
                        $("#UiPageMetadata").append("<option value='" + MetadataId + "'>" + ControleName + "</option>");
                    }
                }
                var idOfRecord = $("#UiPageMetadata").val();
                if (idOfRecord != undefined) {
                    var selectedId = uiPageData[0].value;
                    var changeId = id + " [value=" + selectedId + "]";
                    $(changeId).attr('selected', 'true');
                    $("#WorkflowStageId").val(selectedId);
                }
            },
            error: function (req, status, error) {
            }
        });
    }
    var dataAvailable
    function NonExixt() {
        var selectElement = document.querySelector('.ui-page-metadata-select');
        
        // Check if data is available and set visibility
        if (dataAvailable) {
            selectElement.style.display = 'block';  // Show the dropdown
        } else {
            selectElement.style.display = 'none';   // Hide the dropdown
            document.getElementById('UiControlType').style.display = 'block';
        }
    }
</script>
@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    }
