@model TestingAndCalibrationLabs.Web.UI.Models.RecordsDTO
<style>
    .nav3-link {
        color: dimgray;
        cursor: pointer;
        padding:10px;
        margin:-30px;
        bottom:-30px;
    }
</style>
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Hide Column</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                @{
                  var ind = 0;
                 }
                    @foreach (var item in Model.Fields)
                    {
                    <a class="dropdown-item" href="#" onclick="enable(@ind)">
                    <input type="checkbox" id="gridcheck" checked>
                    @Html.DisplayFor(fieldItem => item.UiControlDisplayName)
                    
                    </a>
                    ind++;
                    }              
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>
<div class="border width-full" style="margin:0;padding:0;border-bottom:2px solid !important;">
    <div class="row mb-1">
        <div class="col-xs-4 col-sm-4 col-md-4 col-lg-6 mt-2">
            <h2 class="mb-2 ms-1 me-1" style="padding:0px 12px;">@if(@Model.Fields.Count()> 0){@Model.Fields.First().UiPageTypeName}</h2>
        </div>


        <div class="col-xs-12 col-sm-5 col-md-4 col-lg-3 mt-3">
             <a class="nav3-link dropdown"  data-bs-toggle="modal" data-bs-target="#exampleModal">
             <i class="fa fa-gear" data-toggle="tooltip" title="Column Configuration" aria-hidden="true"></i>
            </a>
                        <div class="inputSearchGrid text-right">
                <input type="text" id="TestDetailsGridSearch" onkeyup="function()" class="light-table-filter inputWithIconSearch " data-table="table-info" placeholder="Search">
                <i class="fa fa-solid fa-magnifying-glass iconForSearchLeft"></i>
                <i class="fa fa-solid fa-xmark iconForSearchRight" onclick="clearText()"></i>
            </div>
        </div>
    </div>
    
    <div class="table-responsive simple-pagination card shadow border-radius-grid">
        <table id="grid" class="table table-striped dt-responsive nowrap cell-border" width="100%" cellspacing="0">
            <thead>
                <tr>
                    @foreach (var item in Model.Fields)
                    {
                        <th  > @Html.DisplayFor(fieldItem => item.UiControlDisplayName)</th>
                    }
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.FieldValues)
                {
                    int count = 0;
                    <tr >
                        @foreach (var itemValue in item.Value)
                        {
                            <td >
                             @Html.DisplayFor(modelItem => itemValue.Value)
                            </td>
                            if (count == 4)
                            {
                                break;
                            }
                            <td>
                                @Html.DisplayFor(modelItem => itemValue.Value)
                            </td>

                            count++;
                        }
                        <td>
                            <a class="fas fa-edit" style="margin:5px;color:rebeccapurple;" color:black;" asp-controller="Common" asp-action="Edit" asp-route-id="@item.Key"></a>|
                            <a class="fa fa-trash" style="margin:5px;color:red;" data-toggle="modal" data-target="#deleteModalPopup" onclick="setValue(@item.Key)"></a>
                        </td>

                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="deleteModalPopup" tabindex="-1" role="dialog" aria-labelledby="deleteModal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModal">Delete Record</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Are You Sure Want to Delete?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancle</button>
                <button type="button" id="deletePopup" onclick="deleteFun(this.value)" class="button-base button-danger">Delete</button>
            </div>
        </div>
    </div>
</div>
<script>
    var  oTable;
    oTable = $('#testDetailsGrid').DataTable({
        pageLength: 5,
        scrollX: true,
    });
    $('#gridSearch').keyup(function () {
        oTable.search($(this).val()).draw();
    })
    const clearText = () => {
        const inputID = document.querySelector("#gridSearch");
        inputID.value = "";
    } 
    function enable(ind) {
        debugger;
        if (oTable.column(ind).visible() === true) {
            oTable.column(ind).visible(false);
        }
        else {
            oTable.column(ind).visible(true);
        }
    }
    $(document).ready(function () {
    $('[data-toggle="tooltip"]').tooltip();
    });
</script>
