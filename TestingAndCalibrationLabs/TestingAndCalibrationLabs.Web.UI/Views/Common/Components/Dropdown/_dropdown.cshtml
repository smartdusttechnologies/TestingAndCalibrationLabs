@model TestingAndCalibrationLabs.Web.UI.Models.Node<TestingAndCalibrationLabs.Web.UI.Models.UiPageMetadataDTO>
<div class="col-lg-6 col-sm-12 col-xs-12 mt-3  divDrop" >
   <select class=" width-full divSelect" onclick="this.setAttribute('value', this.value);" onchange="this.setAttribute('value', this.value);" value="" name="@Model.Value.UiControlTypeName@Model.Value.Id" id="@Model.Value.UiControlTypeName@Model.Value.Id"  for="@Model.Value.UiControlDisplayName" />
	</select>
	<label class=" divLabel" > @Model.Value.UiControlDisplayName  <span class="red-color">*</span></label>
    <span asp-validation-for="@Model.Value.UiControlDisplayName" class="text-danger"></span>
  </div>

  <script>
    $(document).ready(function () {
        var modelData = JSON.parse('@Json.Serialize(Model)');
        var lookupCategoryId = modelData.value.uiPageMetadata.lookupCategoryId;
        var id = "#" + modelData.value.uiPageMetadata.uiControlTypeName + modelData.value.uiPageMetadata.id;
        var uiPageData = modelData.value.uiPageData;
       

        $.ajax({
            type: "POST",
            url: "@Url.Action("LookupByCategoryId","Lookup")",
            data: { lookupCategoryId : lookupCategoryId },
            success: function (response) {
                for(var i =0; i<response.length; i++){
                    var lookupId = response[i].id;
                    var lookupName = response[i].name;
                    $(id).append("<option value='" + lookupId + "'>" + lookupName + "</option>");
                }
                var idOfRecord = $("#Id").val();
                if (idOfRecord != undefined && uiPageData != null) {
                    var selectedId = uiPageData.value;
                    var changeId = id + " [value=" + selectedId + "]";
                    $(changeId).attr('selected', 'true');
                }
            },
            error: function (req, status, error) {
            }
        });
    });
</script>
